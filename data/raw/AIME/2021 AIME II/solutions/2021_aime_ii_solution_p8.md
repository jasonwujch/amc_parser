# 2021 AIME II Problem 8

## Problem

An ant makes a sequence of moves on a cube where a move consists of walking from one vertex to an adjacent vertex along an edge of the cube. Initially the ant is at a vertex of the bottom face of the cube and chooses one of the three adjacent vertices to move to as its first move. For all moves after the first move, the ant does not return to its previous vertex, but chooses to move to one of the other two adjacent vertices. All choices are selected at random so that each of the possible moves is equally likely. The probability that after exactly $8$ moves that ant is at a vertex of the top face on the cube is $\frac{m}{n}$ , where $m$ and $n$ are relatively prime positive integers. Find $m + n.$

## Solution 1 (Four-Variable Recursion)
For all positive integers $k,$ let
- $N(k,\mathrm{BB})$ be the number of ways to make a sequence of exactly $k$ moves, where the last move is from the bottom face to the bottom face.
- $N(k,\mathrm{BT})$ be the number of ways to make a sequence of exactly $k$ moves, where the last move is from the bottom face to the top face.
- $N(k,\mathrm{TB})$ be the number of ways to make a sequence of exactly $k$ moves, where the last move is from the top face to the bottom face.
- $N(k,\mathrm{TT})$ be the number of ways to make a sequence of exactly $k$ moves, where the last move is from the top face to the top face.
The base case occurs at $k=1,$ from which $\left(N(1,\mathrm{BB}),N(1,\mathrm{BT}),N(1,\mathrm{TB}),N(1,\mathrm{TT})\right)=(2,1,0,0).$
Suppose the ant makes exactly $k$ moves for some $k\geq2.$ We perform casework on its last move:
1. If its last move is from the bottom face to the bottom face, then its next move has
1. If its last move is from the bottom face to the top face, then its next move has $2$ ways to move from the top face to the top face.
1. If its last move is from the top face to the bottom face, then its next move has $2$ ways to move from the bottom face to the bottom face.
1. If its last move is from the top face to the top face, then its next move has way to move from the top face to the bottom face. way to move from the top face to the top face.
- $1$ way to move from the bottom face to the bottom face.
- $1$ way to move from the bottom face to the top face.
- $1$ way to move from the top face to the bottom face.
- $1$ way to move from the top face to the top face.
Alternatively, this recursion argument is illustrated below, where each dashed arrow indicates $1$ way, and each solid arrow indicates $2$ ways: [asy] /* Made by MRENTHUSIASM */ size(9cm); pair A, B, C, D, E, F, G, H, X, Y; A=(0,6); B=(0,4); C=(0,2); D=(0,0); E=(10,6); F=(10,4); G=(10,2); H=(10,0); X=(-1,8); Y=(11,8); label("BB", A, (-2,0)); label("BT", B, (-2,0)); label("TB", C, (-2,0)); label("TT", D, (-2,0)); label("BB", E, (2,0)); label("BT", F, (2,0)); label("TB", G, (2,0)); label("TT", H, (2,0)); label("\textbf{The \boldmath{$k$}th Move}", shift(0.3,0)*X); label("\textbf{The \boldmath{$(k+1)$}th Move}", shift(-0.3,-0.085)*Y); draw(A--E,0.8+black+dashed,EndArrow); draw(A--F,0.8+black+dashed,EndArrow); draw(B--H,0.8+black,EndArrow); draw(C--E,0.8+black,EndArrow); draw(D--G,0.8+black+dashed,EndArrow); draw(D--H,0.8+black+dashed,EndArrow); dot(A^^B^^C^^D^^E^^F^^G^^H, 5+black); [/asy] Therefore, we have the following relationships: \begin{align*} N(1,\mathrm{BB})&=2, \\ N(1,\mathrm{BT})&=1, \\ N(1,\mathrm{TB})&=0, \\ N(1,\mathrm{TT})&=0, \\ N(k+1,\mathrm{BB})&=N(k,\mathrm{BB})+2\cdot N(k,\mathrm{TB}), \\ N(k+1,\mathrm{BT})&=N(k,\mathrm{BB}), \\ N(k+1,\mathrm{TB})&=N(k,\mathrm{TT}), \\ N(k+1,\mathrm{TT})&=N(k,\mathrm{TT})+2\cdot N(k,\mathrm{BT}). \end{align*} Using these equations, we recursively fill out the table below: \[\begin{array}{c||c|c|c|c|c|c|c|c} \hspace{7mm}&\hspace{6.5mm}&\hspace{6.5mm}&\hspace{6.75mm}&\hspace{6.75mm}&\hspace{6.75mm}&\hspace{6.75mm}&& \\ [-2.5ex] \boldsymbol{k} & \boldsymbol{1} & \boldsymbol{2} & \boldsymbol{3} & \boldsymbol{4} & \boldsymbol{5} & \boldsymbol{6} & \boldsymbol{7} & \boldsymbol{8} \\ \hline \hline &&&&&&&& \\ [-2.25ex] \boldsymbol{N(k,\mathrm{BB})} &2&2&2&6&18&38&66&118 \\ \hline &&&&&&&& \\ [-2.25ex] \boldsymbol{N(k,\mathrm{BT})} &1&2&2&2&6&18&38&66 \\ \hline &&&&&&&& \\ [-2.25ex] \boldsymbol{N(k,\mathrm{TB})} &0&0&2&6&10&14&26&62 \\ \hline &&&&&&&& \\ [-2.25ex] \boldsymbol{N(k,\mathrm{TT})} &0&2&6&10&14&26&62&138 \\ \hline \hline &&&&&&&& \\ [-2.25ex] \textbf{Total}&\boldsymbol{3}&\boldsymbol{6}&\boldsymbol{12}&\boldsymbol{24}&\boldsymbol{48}&\boldsymbol{96}&\boldsymbol{192}&\boldsymbol{384} \end{array}\] By the Multiplication Principle, there are $3\cdot2^{k-1}$ ways to make exactly $k$ moves. So, we must get \[N(k,\mathrm{BB})+N(k,\mathrm{BT})+N(k,\mathrm{TB})+N(k,\mathrm{TT})=3\cdot2^{k-1}\] for all values of $k.$
Finally, the requested probability is \[\frac{N(8,\mathrm{BT})+N(8,\mathrm{TT})}{N(8,\mathrm{BB})+N(8,\mathrm{BT})+N(8,\mathrm{TB})+N(8,\mathrm{TT})}=\frac{66+138}{118+66+62+138}=\frac{204}{384}=\frac{17}{32},\] from which the answer is $17+32=\boxed{049}.$
~Arcticturn ~MRENTHUSIASM

## Solution 2 (Markov Chain and Dynamic Programming)
Let the state from bottom to top be $B2T,$ from top to top be $T2T,$ from top to bottom be $T2B,$ and from bottom to bottom be $B2B.$ We can draw the following State Transition Diagram with Markov Chain . The numbers on the transition arc are the transition probabilities.
The probabilities of being in a state after $n$ steps and after $n-1$ steps has the following relationships: \begin{align*} B2T(n) &= B2B(n-1) \cdot \frac12\\ T2T(n) &= B2T(n-1) + T2T(n-1) \cdot \frac12\\ T2B(n) &= T2T(n-1) \cdot \frac12\\ B2B(n) &= T2B(n-1) + B2B(n-1) \cdot \frac12 \end{align*} Those probabilities are calculated by Dynamic Programming in the following table: \[\begin{array}{c|cccc} & & & & \\ [-2ex] n & B2T(n) & T2T(n) & T2B(n) & B2B(n) \\ [1ex] \hline & & & & \\ [-1ex] 1 & \frac13 & 0 & 0 & \frac23\\ & & & & \\ 2 & \frac23 \cdot \frac12 = \frac13 & \frac13 & 0 & \frac23 \cdot \frac12 = \frac13 \\ & & & & \\ 3 & \frac13 \cdot \frac12 = \frac16 & \frac13 + \frac13 \cdot \frac12 = \frac12 & \frac13 \cdot \frac12 = \frac16 & \frac13 \cdot \frac12 = \frac16 \\ & & & & \\ 4 & \frac16 \cdot \frac12 = \frac{1}{12} & \frac16 + \frac12 \cdot \frac12 = \frac{5}{12} & \frac12 \cdot \frac12 = \frac14 & \frac16 + \frac16 \cdot \frac12 = \frac14 \\ & & & & \\ 5 & \frac14 \cdot \frac12 = \frac18 & \frac{1}{12} + \frac{5}{12} \cdot \frac{1}{2} = \frac{7}{24} & \frac{5}{12} \cdot \frac12 = \frac{5}{24} & \frac14 + \frac14 \cdot \frac12 = \frac38 \\ & & & & \\ 6 & \frac38 \cdot \frac12 = \frac{3}{16} & \frac18 + \frac{7}{24} \cdot \frac12 = \frac{13}{48} & \frac{7}{24} \cdot \frac12 = \frac{7}{48} & \frac{5}{24} + \frac38 \cdot \frac12 = \frac{19}{48} \\ & & & & \\ 7 & \frac{19}{48} \cdot \frac12 = \frac{19}{96}& \frac{3}{16} + \frac{13}{48} \cdot \frac{1}{2} = \frac{31}{96}& \frac{13}{48} \cdot \frac{1}{2} = \frac{13}{96} & \frac{7}{48} + \frac{19}{48} \cdot \frac12 = \frac{11}{32}\\ & & & & \\ 8 & \frac{11}{32} \cdot \frac{1}{2} = \frac{11}{64} & \frac{19}{96} + \frac{31}{96} \cdot \frac12 = \frac{23}{64} & \frac{31}{96} \cdot \frac12 = \frac{31}{192} & \frac{13}{96} + \frac{11}{32} \cdot \frac12 = \frac{59}{192} \\ [1ex] \end{array}\] Finally, the requested probability is $\frac{11}{64} + \frac{23}{64} = \frac{17}{32},$ from which the answer is $17 + 32 = \boxed{049}.$
~ isabelchen

## Solution 3 (One-Variable Recursion)
Note that we don't care which exact vertex the ant is located at, just which level (either top face or bottom face). Consider the ant to be on any of the two levels and having moved at least one move. Define $p_i$ to be the probability that after $i$ moves, the ant ends up on the level it started on.
On the first move, the ant can stay on the bottom level with $\frac{2}{3}$ chance and $7$ moves left. Or, it can move to the top level with $\frac{1}{3}$ chance and $6$ moves left (it has to spend another on the top as it can not return immediately). So the requested probability is $P = \frac{2}{3}(1 - p_7) + \frac{1}{3}p_6$ .
Consider when the ant has $i$ moves left (and it's not the ant's first move). It can either stay on its current level with $\frac{1}{2}$ chance and $i - 1$ moves left, or travel to the opposite level with $\frac{1}{2}$ chance, then move to another vertex on the opposite level, to have $i - 2$ moves left. Thus we obtain the recurrence \[p_i = \frac{1}{2}p_{i - 1} + \frac{1}{2}(1 - p_{i - 2})\]
Computing $p_i$ with the starting conditions $p_0 = 1$ and $p_1 = \frac{1}{2}$ , we obtain $p_6 = \frac{33}{64}$ and $p_7 = \frac{59}{128}$ . Hence $P = \frac{2}{3}(1 - p_7) + \frac{1}{3}p_6= \frac{17}{32}$ as desired; $\boxed{049}$ .
~polarity

## Solution 4 (Casework)
On each move, we can either stay on the level we previously were (stay on the bottom/top) or switch levels (go from top to bottom and vise versa). Since we start on the bottom, ending on the top means that we will have to switch an odd number of times; since we cannot switch twice in a row, over an eight-move period we can either make one or three switches. Furthermore, once we switch to a level we can choose one of two directions of traveling on that level: clockwise or counterclockwise (since we can't go back to our previous move, our first move on the level after switching determines our direction).
1. Case 1: one switch. Our one switch can either happen at the start/end of our moves, or in the middle. There are $4 + 24 = 28$ ways to do this, outlined below. Subcase 1: switch happens at ends. If our first move is a switch, then there are two ways to determine the direction we travel along the top layer. Multiply by to count for symmetry (last move is a switch) so this case yields possibilities. Subcase 2: switch happens in the middle. There are six places for the switch to happen; the switch breaks the sequences of moves into two chains, with each having ways to choose their direction of travel. This case yields possibilities.
1. Case 2: three switches. Either two, one, or none of our switches occur at the start/end of our moves. There are $16 + 96 + 64 = 176$ ways to do this, outlined below. (Keep in mind we can't have two switches in a row.) Subcase 1: start and end with a switch. Since our third switch can't be in moves or , there are four ways to place our switch, breaking our sequence into two chains. This case yields possibilities. Subcase 2: one of our switches is at the start/end. WLOG our first move is a switch; moves and cannot be switches. We can choose from any of the remaining moves to be switches, but we have to subtract the illegal cases where the two switches are in a row (3-4, 4-5, 5-6, 6-7). These three switches break our sequence into three chains; accounting for symmetry this case yields possibilities. Subcase 3: all our switches are in the middle. We choose from any of the middle moves to be our switches, but have to subtract the cases where at least two of them are in a row. If at least two switches are in a row, there are five places for the group of and four places for the third switch; however this overcounts the case where all three are in a row, which has possibilities. These three switches break our sequence into four chains, so this case yields possibilities.
1. Subcase 1: switch happens at ends. If our first move is a switch, then there are two ways to determine the direction we travel along the top layer. Multiply by $2$ to count for symmetry (last move is a switch) so this case yields $2^2 = 4$ possibilities.
1. Subcase 2: switch happens in the middle. There are six places for the switch to happen; the switch breaks the sequences of moves into two chains, with each having $2$ ways to choose their direction of travel. This case yields $6 \cdot 2^2 = 24$ possibilities.
1. Subcase 1: start and end with a switch. Since our third switch can't be in moves $2$ or $7$ , there are four ways to place our switch, breaking our sequence into two chains. This case yields $4 \cdot 2^2 = 16$ possibilities.
1. Subcase 2: one of our switches is at the start/end. WLOG our first move is a switch; moves $2$ and $8$ cannot be switches. We can choose $2$ from any of the remaining $5$ moves to be switches, but we have to subtract the $4$ illegal cases where the two switches are in a row (3-4, 4-5, 5-6, 6-7). These three switches break our sequence into three chains; accounting for symmetry this case yields $2\left(\binom{5}{2} - 4\right) \cdot 2^3 = 96$ possibilities.
1. Subcase 3: all our switches are in the middle. We choose $3$ from any of the $6$ middle moves to be our switches, but have to subtract the cases where at least two of them are in a row. If at least two switches are in a row, there are five places for the group of $2$ and four places for the third switch; however this overcounts the case where all three are in a row, which has $4$ possibilities. These three switches break our sequence into four chains, so this case yields $\left(\binom{6}{3} - 5 \cdot 4 + 4\right) \cdot 2^4 = 64$ possibilities.
Our probability is then $\frac{176 + 28}{3 \cdot 2^7} = \frac{17}{32}$ , so the answer is $17+32=\boxed{049}$ .

## Solution 5 (One-Variable Recursion and Casework)
Let $p(n)$ be the probability that we are on the top when you get to the $n$ th move, and $p(n-1)$ and $p(n-2)$ be the probability that you are on the top when you get to the $(n-1)$ th move and $(n-2)$ th move respectively.
Now you can do some recursion, splitting up into cases:
Case 1: You are not on the top for the $(n-1)$ th move or the $(n-2)$ th move. In this case, it is a $1-p(n-1)$ chance that you were not on the top for the $(n-1)$ th move, and a $1-p(n-2)$ that you are not on the top for the $(n-2)$ th move. This leads you to a $\frac{1}{2}\cdot(1-p(n-1))\cdot(1-p(n-2))$ chance for the first case. (The $\frac12$ is there because of the fact that you can go up and you can also stay on the bottom side, as you cannot return.)
Case 2: You are on the top for the $(n-1)$ th move, but not on the top for the $(n-2)$ th move. This leads you to a $p(n-1)\cdot(1-p(n-2))$ probability (no extra components because you cannot return).
Case 3: You are on top for both the $(n-1)$ th move and the $(n-2)$ th move. This leads to a probability of $\frac{1}{2}\cdot p(n-1)\cdot p(n-2)$ (adding the extra $\frac12$ because you can either stay on the top or go down.
As the 4th case requires you to go down then up, but you cannot retrace, there is no $4$ th case.
These cases, added up, lead you to \[p(n)=\frac{1}{2}\cdot(1-p(n-1))(1-p(n-2))+p(n-1)(1-p(n-2))+\frac{1}{2}\cdot p(n-1)p(n-2).\] This can be further simplified down by expanding and combining like terms to \[p(n)=\frac{1+p(n-1)-p(n-2)}{2}.\] Then we must find $p(1)$ and $p(2)$ . p(1) is trivially $\frac{1}{3}$ . You can find $p(2)$ using basic probability techniques that is left as an exercise to the reader to get $\frac{2}{3}$ . In the end, you plug in to get \[p(1)=\frac{1}{3}, P(2)=\frac{2}{3}, P(3)=\frac{2}{3}, P(4)=\frac{1}{2}, P(5)=\frac{5}{12}, P(6)=\frac{11}{24}, P(7)=\frac{25}{48}, P(8)=\boxed{\frac{17}{32}}.\] Therefore, the answer is $17+32=\boxed{049}$ .
~dragoon
### Remark (Markov Chain)
This problem is similar to the following problems:
- 1985 AIME Problem 12
- 2003 AIME II Problem 13
- 2021 AMC 12A Problem 23
- 2022 AMC 8 Problem 25
They can all be solved by Markov Chain and Dynamic Programming .
Let $p_{ij} = P(X_{n+1} = j | X_n = i)$ be the probability that state $i$ transits to state $j$ on the next step, and $s_i$ be the probability of being in state $i$ . It follows that $s_j$ is the sum of the products of $s_i$ and $p_{ij}$ of all the previous state $i$ : \[s_j = \sum_{i} (s_{i} \cdot p_{ij}).\] This formula can also be applied to solve 2019 AMC10B Problem 22 .
~ isabelchen

## Video Solution
https://youtu.be/dBLEe0oczuA
~Interstigation

## Video Solution
https://youtu.be/4UjQhFEa1ms
~MathProblemSolvingSkills.com
### See Also
These problems are copyrighted © by the Mathematical Association of America.
These problems are copyrighted © by the Mathematical Association of America.
These problems are copyrighted © by the Mathematical Association of America.
These problems are copyrighted © by the Mathematical Association of America .